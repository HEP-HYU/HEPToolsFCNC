  #!/usr/bin/env python
Train on 40000 samples, validate on 20000 samples
Epoch 1/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.7483 - acc: 0.6322Epoch 00000: val_loss improved from inf to 0.07112, saving model to keras_smallinput3/weights/TrainedModel_PyKeras.h5
40000/40000 [==============================] - 4s - loss: 0.7483 - acc: 0.6320 - val_loss: 0.0711 - val_acc: 0.6855
Epoch 2/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.6217 - acc: 0.6660Epoch 00001: val_loss improved from 0.07112 to 0.07096, saving model to keras_smallinput3/weights/TrainedModel_PyKeras.h5
40000/40000 [==============================] - 4s - loss: 0.6217 - acc: 0.6660 - val_loss: 0.0710 - val_acc: 0.6898
Epoch 3/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.6023 - acc: 0.6789Epoch 00002: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.6027 - acc: 0.6785 - val_loss: 0.0718 - val_acc: 0.6937
Epoch 4/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5929 - acc: 0.6839Epoch 00003: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5930 - acc: 0.6838 - val_loss: 0.0718 - val_acc: 0.6926
Epoch 5/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5907 - acc: 0.6842Epoch 00004: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5906 - acc: 0.6842 - val_loss: 0.0722 - val_acc: 0.6940
Epoch 6/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5868 - acc: 0.6898Epoch 00005: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5868 - acc: 0.6898 - val_loss: 0.0717 - val_acc: 0.6965
Epoch 7/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5865 - acc: 0.6889Epoch 00006: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5864 - acc: 0.6889 - val_loss: 0.0712 - val_acc: 0.6963
Epoch 8/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5838 - acc: 0.6900Epoch 00007: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5841 - acc: 0.6898 - val_loss: 0.0719 - val_acc: 0.6972
Epoch 9/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5835 - acc: 0.6921Epoch 00008: val_loss improved from 0.07096 to 0.07078, saving model to keras_smallinput3/weights/TrainedModel_PyKeras.h5
40000/40000 [==============================] - 4s - loss: 0.5837 - acc: 0.6919 - val_loss: 0.0708 - val_acc: 0.6953
Epoch 10/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5815 - acc: 0.6941Epoch 00009: val_loss improved from 0.07078 to 0.07051, saving model to keras_smallinput3/weights/TrainedModel_PyKeras.h5
40000/40000 [==============================] - 4s - loss: 0.5813 - acc: 0.6941 - val_loss: 0.0705 - val_acc: 0.6958
Epoch 11/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5821 - acc: 0.6930Epoch 00010: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5819 - acc: 0.6931 - val_loss: 0.0707 - val_acc: 0.6969
Epoch 12/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5796 - acc: 0.6970Epoch 00011: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5797 - acc: 0.6967 - val_loss: 0.0708 - val_acc: 0.6986
Epoch 13/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5803 - acc: 0.6946Epoch 00012: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5803 - acc: 0.6946 - val_loss: 0.0709 - val_acc: 0.6972
Epoch 14/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5792 - acc: 0.6932Epoch 00013: val_loss improved from 0.07051 to 0.07044, saving model to keras_smallinput3/weights/TrainedModel_PyKeras.h5
40000/40000 [==============================] - 4s - loss: 0.5792 - acc: 0.6932 - val_loss: 0.0704 - val_acc: 0.6980
Epoch 15/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5780 - acc: 0.6963Epoch 00014: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5781 - acc: 0.6962 - val_loss: 0.0707 - val_acc: 0.6975
Epoch 16/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5773 - acc: 0.6957Epoch 00015: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5773 - acc: 0.6959 - val_loss: 0.0705 - val_acc: 0.6973
Epoch 17/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5775 - acc: 0.6965Epoch 00016: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5774 - acc: 0.6966 - val_loss: 0.0705 - val_acc: 0.6985
Epoch 18/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5769 - acc: 0.6976Epoch 00017: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5771 - acc: 0.6975 - val_loss: 0.0705 - val_acc: 0.6988
Epoch 19/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5770 - acc: 0.6956Epoch 00018: val_loss did not improve
40000/40000 [==============================] - 4s - loss: 0.5769 - acc: 0.6956 - val_loss: 0.0707 - val_acc: 0.6988
Epoch 20/20
39800/40000 [============================>.] - ETA: 0s - loss: 0.5769 - acc: 0.6970Epoch 00019: val_loss improved from 0.07044 to 0.07010, saving model to keras_smallinput3/weights/TrainedModel_PyKeras.h5
40000/40000 [==============================] - 4s - loss: 0.5769 - acc: 0.6972 - val_loss: 0.0701 - val_acc: 0.6986
                         : Elapsed time for training with 40000 events: 93.9 sec         
                         : Creating xml weight file: keras_smallinput3/weights/TMVAClassification_PyKeras.weights.xml
                         : Creating standalone class: keras_smallinput3/weights/TMVAClassification_PyKeras.class.C
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
BDT                      : Ranking result (top variable is best ranked)
                         : --------------------------------------------
                         : Rank : Variable   : Variable Importance
                         : --------------------------------------------
                         :    1 : DRjet2csv  : 6.196e-02
                         :    2 : DRjet2cvsb : 6.165e-02
                         :    3 : DRjet12DR  : 5.846e-02
                         :    4 : njets      : 5.835e-02
                         :    5 : DRjet3csv  : 5.681e-02
                         :    6 : DRjet0cvsb : 5.572e-02
                         :    7 : DRjet3cvsb : 5.541e-02
                         :    8 : DRjet12m   : 5.434e-02
                         :    9 : DRjet0cvsl : 5.330e-02
                         :   10 : DRjet3cvsl : 5.328e-02
                         :   11 : DRjet2cvsl : 5.034e-02
                         :   12 : DRlepTm    : 4.744e-02
                         :   13 : DRjet0csv  : 4.692e-02
                         :   14 : DRjet23m   : 4.677e-02
                         :   15 : DRjet1cvsb : 4.642e-02
                         :   16 : DRjet1csv  : 4.432e-02
                         :   17 : DRjet31m   : 4.365e-02
                         :   18 : DRjet1cvsl : 4.266e-02
                         :   19 : DRhadTm    : 4.064e-02
                         :   20 : nbjets_m   : 2.157e-02
                         : --------------------------------------------
                         : No variable ranking supplied by classifier: PyKeras
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
Factory                  : Test all methods
Factory                  : Test method: BDT for Classification performance
                         : 
BDT                      : [keras_smallinput3] : Evaluation of BDT on testing sample (20000 events)
                         : Elapsed time for evaluation of 20000 events: 1.11 sec       
Factory                  : Test method: PyKeras for Classification performance
                         : 
                         : Load model from file: keras_smallinput3/weights/TrainedModel_PyKeras.h5
Factory                  : Evaluate all methods
Factory                  : Evaluate classifier: BDT
                         : 
BDT                      : [keras_smallinput3] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_BDT            :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      njets:      5.1495      1.1737   [      4.0000      12.000 ]
                         :   nbjets_m:      3.0914     0.30086   [      3.0000      6.0000 ]
                         :  DRjet0csv:     0.64857     0.36127   [    0.047799     0.99959 ]
                         : DRjet0cvsl:     0.40994     0.52898   [    -0.74829     0.99719 ]
                         : DRjet0cvsb:    -0.13832     0.55549   [    -0.98423     0.83870 ]
                         :  DRjet1csv:     0.97899    0.027423   [     0.84896     0.99961 ]
                         : DRjet1cvsl:     0.87654     0.16967   [    -0.55178     0.99675 ]
                         : DRjet1cvsb:    -0.72336     0.25044   [    -0.98680     0.68049 ]
                         :  DRjet2csv:     0.93187    0.045416   [     0.84841     0.99938 ]
                         : DRjet2cvsl:     0.81169     0.22382   [    -0.56092     0.99703 ]
                         : DRjet2cvsb:    -0.42983     0.34126   [    -0.98707     0.77777 ]
                         :  DRjet3csv:     0.45198     0.31920   [    0.045558     0.99797 ]
                         : DRjet3cvsl:     0.14795     0.48625   [    -0.81869     0.99571 ]
                         : DRjet3cvsb:     0.20875     0.38007   [    -0.96777     0.85257 ]
                         :   DRjet12m:      109.19      58.609   [      15.694      1115.3 ]
                         :  DRjet12DR:      1.4954     0.61676   [     0.39151      4.4080 ]
                         :   DRjet23m:      108.19      72.248   [      17.803      1319.0 ]
                         :   DRjet31m:      108.76      67.608   [      17.070      1015.8 ]
                         :    DRlepTm:      263.58      168.17   [      27.131      5303.8 ]
                         :    DRhadTm:      196.89      96.603   [      42.430      1583.2 ]
                         : ---------------------------------------------------------------------
Factory                  : Evaluate classifier: PyKeras
                         : 
TFHandler_PyKeras        :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      njets:   -0.042622     0.98267   [     -5.7307      5.7307 ]
                         :   nbjets_m:  -0.0044301      1.0054   [     -5.7307      5.7307 ]
                         :  DRjet0csv:   0.0066981     0.98031   [     -3.6117      5.7307 ]
                         : DRjet0cvsl:    0.012025     0.99190   [     -5.7307      5.7307 ]
                         : DRjet0cvsb:   -0.038818      1.0075   [     -5.7307      5.7307 ]
                         :  DRjet1csv:  -0.0018146     0.97496   [     -5.7307      5.7307 ]
                         : DRjet1cvsl:  -0.0067617     0.97459   [     -3.4163      5.7307 ]
                         : DRjet1cvsb:   -0.012999     0.97709   [     -3.3408      5.7307 ]
                         :  DRjet2csv:    0.027592     0.99641   [     -3.2739      3.6243 ]
                         : DRjet2cvsl:   0.0042714     0.96057   [     -3.1680      3.4960 ]
                         : DRjet2cvsb:   -0.045027     0.98856   [     -3.1532      5.7307 ]
                         :  DRjet3csv:    0.028404     0.99431   [     -3.2071      5.7307 ]
                         : DRjet3cvsl:    0.036739      1.0232   [     -3.1210      5.7307 ]
                         : DRjet3cvsb:   0.0011529      1.0236   [     -3.1072      3.8364 ]
                         :   DRjet12m:   0.0071542     0.97161   [     -3.4344      5.7307 ]
                         :  DRjet12DR:    0.019871      1.0051   [     -3.2359      5.7307 ]
                         :   DRjet23m:  0.00047154     0.99840   [     -3.1384      5.7307 ]
                         :   DRjet31m:  -0.0073962     0.98798   [     -3.1688      3.4297 ]
                         :    DRlepTm:   -0.044656     0.99552   [     -3.0625      5.7307 ]
                         :    DRhadTm:   0.0090765     0.97587   [     -3.9869      5.7307 ]
                         : ---------------------------------------------------------------------
PyKeras                  : [keras_smallinput3] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_PyKeras        :   Variable          Mean          RMS   [        Min          Max ]
                         : ---------------------------------------------------------------------
                         :      njets:   -0.042622     0.98267   [     -5.7307      5.7307 ]
                         :   nbjets_m:  -0.0044301      1.0054   [     -5.7307      5.7307 ]
                         :  DRjet0csv:   0.0066981     0.98031   [     -3.6117      5.7307 ]
                         : DRjet0cvsl:    0.012025     0.99190   [     -5.7307      5.7307 ]
                         : DRjet0cvsb:   -0.038818      1.0075   [     -5.7307      5.7307 ]
                         :  DRjet1csv:  -0.0018146     0.97496   [     -5.7307      5.7307 ]
                         : DRjet1cvsl:  -0.0067617     0.97459   [     -3.4163      5.7307 ]
                         : DRjet1cvsb:   -0.012999     0.97709   [     -3.3408      5.7307 ]
                         :  DRjet2csv:    0.027592     0.99641   [     -3.2739      3.6243 ]
                         : DRjet2cvsl:   0.0042714     0.96057   [     -3.1680      3.4960 ]
                         : DRjet2cvsb:   -0.045027     0.98856   [     -3.1532      5.7307 ]
                         :  DRjet3csv:    0.028404     0.99431   [     -3.2071      5.7307 ]
                         : DRjet3cvsl:    0.036739      1.0232   [     -3.1210      5.7307 ]
                         : DRjet3cvsb:   0.0011529      1.0236   [     -3.1072      3.8364 ]
                         :   DRjet12m:   0.0071542     0.97161   [     -3.4344      5.7307 ]
                         :  DRjet12DR:    0.019871      1.0051   [     -3.2359      5.7307 ]
                         :   DRjet23m:  0.00047154     0.99840   [     -3.1384      5.7307 ]
                         :   DRjet31m:  -0.0073962     0.98798   [     -3.1688      3.4297 ]
                         :    DRlepTm:   -0.044656     0.99552   [     -3.0625      5.7307 ]
                         :    DRhadTm:   0.0090765     0.97587   [     -3.9869      5.7307 ]
                         : ---------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : keras_smallinput3 BDT            : 0.776
                         : keras_smallinput3 PyKeras        : 0.766
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : keras_smallinput3    BDT            : 0.136 (0.184)       0.452 (0.481)      0.708 (0.723)
                         : keras_smallinput3    PyKeras        : 0.133 (0.151)       0.432 (0.445)      0.696 (0.703)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:keras_smallinput3: Created tree 'TestTree' with 20000 events
                         : 
Dataset:keras_smallinput3: Created tree 'TrainTree' with 40000 events

